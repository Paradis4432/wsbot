<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>imagenes</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
</head>

<body style="background-color: grey;">


    <button><a href="/">home</a></button>
    <button><a href="/negocios/{{neg}}">atras</a></button>

    <meta id="data" data="{{srcs}}" neg="{{neg}}" t="{{t}}">

    <div class="container-fluid">
        {% for src in srcs %}
        <div class="row">
            <div class="col">
                <button><a href="/groupInfo/{{neg}}/{{t}}/{{src}}">grupo: {{srcs[src]["uniqueID"]}}</a></button>
                <button imgsNames="{{srcs[src]['images']}}" onclick="download(this)">des {{src}}</button>
            </div>
            <div class="col">
                <img data-enlargable src="../../static/{{srcs[src]['images'][0]}}" alt="img" height="80px" width="80px"
                    onclick="changeImgSize(this)">
            </div>
        </div>
        {% endfor %}

    </div>


    <script>
        function download(el) {
            const srcs = JSON.parse(el.getAttribute("imgsNames").replace(/'/g, '"'));

            for (let i = 0; i < srcs.length; i++) {
                const link = document.createElement('a');
                link.href = "/download/" + srcs[i];
                link.target = "_blank";
                link.download = srcs[i];
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }

        first = true

        function changeImgSize(el) {
            if (!first) return;

            var src = el.getAttribute('src');
            var div = document.createElement('div');
            div.style.background = 'RGBA(0,0,0,.5) url(' + src + ') no-repeat center';
            div.style.backgroundSize = 'contain';
            div.style.width = '100%';
            div.style.height = '100%';
            div.style.position = 'fixed';
            div.style.zIndex = '10000';
            div.style.top = '0';
            div.style.left = '0';
            div.style.cursor = 'zoom-out';

            div.onclick = function () {
                this.remove();
            };

            document.body.appendChild(div);
            first = false;
        }

        var imgList = document.querySelectorAll('img[data-enlargable]');
        for (var i = 0; i < imgList.length; i++) {
            imgList[i].classList.add('img-enlargable');
            imgList[i].addEventListener('click', function () {
                changeImgSize(this);
                first = true;
            });
        }


    </script>
</body>

</html>